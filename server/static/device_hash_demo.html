<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Hash Demo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.11.1/sha256.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background: #f7f7f7; }
        .container { max-width: 400px; margin: 80px auto; background: #fff; padding: 32px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; }
        button { padding: 10px 24px; font-size: 1rem; border-radius: 4px; border: none; background: #007bff; color: #fff; cursor: pointer; }
        #hash-output { margin-top: 24px; font-size: 1.1rem; word-break: break-all; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Device Hash Generator</h2>
        <button id="hashBtn"><i class="fa-solid fa-hashtag"></i> Generate Hash</button>
        <div id="hash-output"></div>
    </div>
    <script>
        async function getGPUName() {
            // Try to get GPU info using WebGL
            let gl = document.createElement('canvas').getContext('webgl');
            if (!gl) return 'UnknownGPU';
            let debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
            if (debugInfo) {
                return gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
            }
            return 'UnknownGPU';
        }

        function getDeviceId() {
            // For demo: generate a random device ID (in real use, use a persistent identifier)
            let id = localStorage.getItem('device_id');
            if (!id) {
                id = 'dev-' + Math.random().toString(36).substr(2, 12);
                localStorage.setItem('device_id', id);
            }
            return id;
        }

        async function hashDeviceInfo() {
            const gpuName = await getGPUName();
            const deviceId = getDeviceId();
            const data = gpuName + ':' + deviceId;
            // SHA-256 hash using Web Crypto API
            const encoder = new TextEncoder();
            const dataBuffer = encoder.encode(data);
            const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        document.getElementById('hashBtn').onclick = async function() {
            const hashHex = await hashDeviceInfo();
            document.getElementById('hash-output').innerHTML =
                `<strong>SHA-256 Hash:</strong><br>${hashHex}`;
        };
    </script>
</body>
</html>
